services:
  web:
    build: .
    image: ghcr.io/katherlab/llmaix:latest
    ports:
      - "19999:${PORT:-5000}"
    volumes:
      # Adjust: /path/to/your/local/model/dir:/models - don't modify the path after the colon!
      - /PATH/TO/YOUR/LOCAL/MODEL/DIR:/models
    environment:
      - SERVER_PATH=${SERVER_PATH:-/build/llama.cpp/llama-server}
      - PORT=${PORT:-5000}
      - HOST=${HOST:-0.0.0.0}
      # Adjust if your model config in your models directory has another name than config.yml
      - CONFIG_FILE=${CONFIG_FILE:-/models/config.yml}
      - GPU=${GPU:-ALL}
      - LLAMACPP_PORT=${LLAMACPP_PORT:-2929}
      - DEBUG=${DEBUG:-false}
      - MODE=${MODE:-choice}
      - NO_PARALLEL_PREPROCESSING=${NO_PARALLEL_PREPROCESSING:-false}
      - CONTEXT_SIZE=${CONTEXT_SIZE:- -1}
      - VERBOSE_LLAMA=${VERBOSE_LLAMA:-false}
      - NO_PASSWORD=${NO_PASSWORD:-false}
    deploy:
      resources:
        reservations:
          devices:
          - driver: nvidia
            device_ids: ['0']
            capabilities: [gpu]
